---
title: 管道符、重定向与环境变量
date: 2020-11-21
categories:
  - Linux
tags:
  - Linux
---

输入输出重定向

标准输入重定向（STDIN，文件描述符为 0）：默认从键盘输入，也可从其他文件或命令中输入。

标准输出重定向（STDOUT，文件描述符为 1）：默认输出到屏幕。

错误输出重定向（STDERR，文件描述符为 2）：默认输出到屏幕。

表 3-1 输入重定向中用到的符号及其作用

| 符号                   | 作用                                            |
| ---------------------- | ----------------------------------------------- |
| 命令 < 文件            | 将文件作为命令的标准输入                        |
| 命令 << 分界符         | 从标准输入中读入，直到遇见分界符才停止          |
| 命令 < 文件 1 > 文件 2 | 将文件 1 作为命令的标准输入并将标准输出到文件 2 |

表 3-2 输出重定向中用到的符号及其作用

| 符号                               | 作用                                                         |
| ---------------------------------- | ------------------------------------------------------------ |
| 命令 > 文件                        | 将标准输出重定向到一个文件中（清空原有文件的数据）           |
| 命令 2> 文件                       | 将错误输出重定向到一个文件中（清空原有文件的数据）           |
| 命令 >> 文件                       | 将标准输出重定向到一个文件中（追加到原有内容的后面）         |
| 命令 2>> 文件                      | 将错误输出重定向到一个文件中（追加到原有内容的后面）         |
| 命令 >> 文件 2>&1 或 命令 &>> 文件 | 将标准输出与错误输出共同写入到文件中（追加到原有内容的后面） |

## 管道符

管道命令符的作用可以用一句话来概括**“把前一个命令原本要输出到屏幕的标准正常数据当作是后一个命令的标准输入”**。

其执行格式为“命令 A | 命令 B”。

找出被限制登录用户的命令是 grep "/sbin/nologin" /etc/passwd；

统计文本行数的命令则是 wc -l。

```
grep "/sbin/nologin" /etc/passwd | wc -l
```

![管道符示例](.\picture\管道符示例1.png)

**注意：**

**大家千万不要误以为管道命令符只能在一个命令组合中使用一次，我们完全可以这样使用：“命令 A | 命令 B | 命令 C”。**

## 命令行的通配符

通配符就是通用的匹配信息的符号，比如**星号（\*）代表匹配零个或多个字符，问号（?）代表匹配单个字符，中括号内加上数字[0-9]代表匹配 0 ～ 9 之间的单个数字的字符，也可以用[135]这样的方式仅匹配这三个指定数字中的一个。而中括号内加上字母[abc]则是代表匹配 a、b、c 三个字符中的任意一个字符。**

通配符示例：想要批量查看所有硬盘文件的相关权限属性

```
ls -l /dev/sda*
```

```
ls -l /dev/sda?
```

![通配符示例](.\picture\通配符示例1.png)

## 转义符

4 个常用的转义符

反斜杠（\）：使反斜杠后面的一个变量变为单纯的字符串。

单引号（''）：转义其中所有的变量为单纯的字符串。

双引号（""）：保留其中的变量属性，不进行转义处理。

反引号（``）：把其中的命令执行后返回结果。

![转义符示例](.\picture\转义符示例1.png)

## 环境变量

命令在 Linux 中的执行分为 4 个步骤。

**第 1 步**：判断用户是否以绝对路径或相对路径的方式输入命令（如/bin/ls），如果是的话则直接执行。

**第 2 步**：Linux 系统检查用户输入的命令是否为“别名命令”，即用一个自定义的命令名称来替换原本的命令名称。可以用 alias 命令来创建一个属于自己的命令别名，格式为“alias 别名=命令”。若要取消一个命令别名，则是用 unalias 命令，格式为“unalias 别名”。我们之前在使用 rm 命令删除文件时，Linux 系统都会要求我们再确认是否执行删除操作，其实这就是 Linux 系统为了防止用户误删除文件而特意设置的 rm 别名命令，接下来我们把它取消掉：

```
[root@linuxprobe ~]# ls
anaconda-ks.cfg Documents initial-setup-ks.cfg Pictures Templates
Desktop Downloads Music Public Videos
[root@linuxprobe ~]# rm anaconda-ks.cfg
rm: remove regular file ‘anaconda-ks.cfg’? y
[root@linuxprobe~]# alias rm
alias rm='rm -i'
[root@linuxprobe ~]# unalias rm
[root@linuxprobe ~]# rm initial-setup-ks.cfg
[root@linuxprobe ~]#
```

**第 3 步**：Bash 解释器判断用户输入的是内部命令还是外部命令。内部命令是解释器内部的指令，会被直接执行；而用户在绝大部分时间输入的是外部命令，这些命令交由步骤 4 继续处理。可以使用“type 命令名称”来判断用户输入的命令是内部命令还是外部命令。

**第 4 步**：系统在多个路径中查找用户输入的命令文件，而定义这些路径的变量叫作 PATH，可以简单地把它理解成是“解释器的小助手”，作用是告诉 Bash 解释器待执行的命令可能存放的位置，然后 Bash 解释器就会乖乖地在这些位置中逐个查找。PATH 是由多个路径值组成的变量，每个路径值之间用冒号间隔，对这些路径的增加和删除操作将影响到 Bash 解释器对 Linux 命令的查找。

```
[root@linuxprobe ~]# echo $PATH
/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin
[root@linuxprobe ~]# PATH=$PATH:/root/bin
[root@linuxprobe ~]# echo $PATH
/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:/root/bin
```

表 3-3 Linux 系统中最重要的 10 个环境变量

| 变量名称     | 作用                             |
| ------------ | -------------------------------- |
| HOME         | 用户的主目录（即家目录）         |
| SHELL        | 用户在使用的 Shell 解释器名称    |
| HISTSIZE     | 输出的历史命令记录条数           |
| HISTFILESIZE | 保存的历史命令记录条数           |
| MAIL         | 邮件保存路径                     |
| LANG         | 系统语言、语系名称               |
| RANDOM       | 生成一个随机数字                 |
| PS1          | Bash 解释器的提示符              |
| PATH         | 定义解释器搜索用户执行命令的路径 |
| EDITOR       | 用户默认的文本编辑器             |
